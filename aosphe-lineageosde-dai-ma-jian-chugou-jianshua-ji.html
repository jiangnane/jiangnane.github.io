<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>AOSP和LineageOS的代码检出、构建、刷机 - HEIN&#x27;s Blog</title><meta name="robots" content="noindex,nofollow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="alternate" type="application/atom+xml" href="https://blog.nasyes.cn/feed.xml" title="HEIN&#x27;s Blog - RSS"><link rel="alternate" type="application/json" href="https://blog.nasyes.cn/feed.json" title="HEIN&#x27;s Blog - JSON"><meta property="og:title" content="AOSP和LineageOS的代码检出、构建、刷机"><meta property="og:site_name" content="HEIN's Blog"><meta property="og:description" content="AOSP部分 环境要求 硬件 处理器：2.3.x以上Android版本需要64位架构的处理器 内存：官方最低16G，谷歌推荐64G；实测虚拟机32G以下内存有概率崩溃，物理机没问题，虚拟机建议至少40G内存 硬盘：代码250G，编译再加150G，建议500G以上SSD 网络：保证网络稳定，否则检出代码很容易中断 参考：虚拟机+i5 10700 + 32G内存+SSD，检出代码约4小时，编译、链接、打包约3.5个小时 Ubuntu 22.04 LTS x64 JDK AOSP自带 Make AOSP自带 Python 3 sudo apt install git-core&hellip;"><meta property="og:url" content="https://blog.nasyes.cn/aosphe-lineageosde-dai-ma-jian-chugou-jianshua-ji.html"><meta property="og:type" content="article"><link rel="preload" href="https://blog.nasyes.cn/assets/dynamic/fonts/jetbrainsmono/jetbrainsmono.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://blog.nasyes.cn/assets/css/style.css?v=1f557c81d98d81d721608200b8db7e33"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.nasyes.cn/aosphe-lineageosde-dai-ma-jian-chugou-jianshua-ji.html"},"headline":"AOSP和LineageOS的代码检出、构建、刷机","datePublished":"2024-03-26T17:39+08:00","dateModified":"2024-10-29T10:35+08:00","description":"AOSP部分 环境要求 硬件 处理器：2.3.x以上Android版本需要64位架构的处理器 内存：官方最低16G，谷歌推荐64G；实测虚拟机32G以下内存有概率崩溃，物理机没问题，虚拟机建议至少40G内存 硬盘：代码250G，编译再加150G，建议500G以上SSD 网络：保证网络稳定，否则检出代码很容易中断 参考：虚拟机+i5 10700 + 32G内存+SSD，检出代码约4小时，编译、链接、打包约3.5个小时 Ubuntu 22.04 LTS x64 JDK AOSP自带 Make AOSP自带 Python 3 sudo apt install git-core&hellip;","author":{"@type":"Person","name":"HEIN","url":"https://blog.nasyes.cn/authors/hein/"},"publisher":{"@type":"Organization","name":"HEIN"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="container container--center"><header class="header"><div class="header__logo"><a class="logo" href="https://blog.nasyes.cn/">HEIN&#x27;s Blog</a></div></header><main class="content"><article class="post"><header><h1 class="post__title">AOSP和LineageOS的代码检出、构建、刷机</h1><div class="post__meta"><time datetime="2024-03-26T17:39" class="post__date">三月 26, 2024 </time><span class="post__author"><a href="https://blog.nasyes.cn/authors/hein/" class="feed__author">HEIN</a></span></div></header><div class="post__entry"><h2 id="aosp部分"><strong>AOSP部分</strong></h2><h3 id="环境要求"><strong>环境要求</strong></h3><h6 id="硬件"><strong>硬件</strong></h6><p>处理器：2.3.x以上Android版本需要64位架构的处理器<br>内存：官方最低16G，谷歌推荐64G；实测虚拟机32G以下内存有概率崩溃，物理机没问题，虚拟机建议至少40G内存<br>硬盘：代码250G，编译再加150G，建议500G以上SSD<br>网络：保证网络稳定，否则检出代码很容易中断<br>参考：虚拟机+i5 10700 + 32G内存+SSD，检出代码约4小时，编译、链接、打包约3.5个小时</p><h6 id="软件"><strong>软件</strong></h6><p>Ubuntu 22.04 LTS x64<br>JDK AOSP自带<br>Make AOSP自带<br>Python 3</p><pre><code>sudo apt install git-core gnupg flex bison build-essential zip curl zlib1g-dev libc6-dev-i386 libncurses5 lib32ncurses5-dev x11proto-core-dev libx11-dev lib32z1-dev libgl1-mesa-dev libxml2-utils xsltproc unzip fontconfig
</code></pre><p>以上都是针对Android9.0及以上版本的环境配置</p><h3 id="下载代码"><strong>下载代码</strong></h3><p>清华源：<a href="https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/">https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/</a><br>科大源：<a href="https://mirrors.ustc.edu.cn/help/aosp.html">https://mirrors.ustc.edu.cn/help/aosp.html</a><br>谷歌官方的方法不适合国内，参考:<br><a href="https://source.android.google.cn/docs/setup/download/downloading">https://source.android.google.cn/docs/setup/download/downloading</a></p><h6 id="方法一："><strong>方法一：</strong></h6><p>以下是推荐的国内下载代码方法 <strong>“</strong> 初始同步方法 第一次同步数据量特别大，如果网络不稳定，中间失败就要从头再来了。所以我们提供了打包的 AOSP 镜像，为一个 tar 包，大约 200G（单文件 200G，注意你的磁盘格式要支持）。这样你 就可以通过 HTTP(S) 的方式下载，该方法支持断点续传。 下载地址: <a href="https://mirrors.ustc.edu.cn/aosp-monthly/">https://mirrors.ustc.edu.cn/aosp-monthly/</a><br>请注意对比 checksum。<br>然后根据下文 <em><strong>替换已有的AOSP源代码的remote</strong></em> 的方法更改同步地址。<br>解压后用命令 repo sync 就可以把代码都 checkout 出来。</p><p>Note: tar 包为定时从 <a href="https://mirrors.tuna.tsinghua.edu.cn/aosp-monthly/">https://mirrors.tuna.tsinghua.edu.cn/aosp-monthly/</a> 下载。 <strong>”</strong></p><figure class="jop-noMdConv"><img loading="lazy" width="552" height="219" src="./media/files/wps14.png" data-is-external-image="true"></figure><h6 id="方法二："><strong>方法二：</strong></h6><p><strong>“</strong> 如果想用官方步骤+国内镜像地址的方法，将官方步骤中的 <a href="https://android.googlesource.com/">https://android.googlesource.com/</a> 全部使用 <a href="https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/">https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/</a> 代替即可。由于使用 HTTPS 协议更安全，并且更便于我们灵活处理，所以强烈推荐使用 HTTPS 协议同步 AOSP 镜像。由于 AOSP 镜像造成CPU/内存负载过重，我们限制了并发数量，因此建议：sync的时候并发数不宜太高，否则会出现 503 错误，即-j后面的数字不能太大，建议选择4。请尽量选择流量较小时错峰同步。 <strong>”</strong></p><h6 id="分支选择">分支选择</h6><figure class="jop-noMdConv">参考：<a href="https://source.android.google.cn/setup/start/build-numbers#source-code-tags-and-builds">https://source.android.google.cn/setup/start/build-numbers#source-code-tags-and-builds</a><br><img loading="lazy" width="553" height="173" src="./media/files/wps15.jpg" data-is-external-image="true"></figure>上图是可用AOSP TAG<figure class="jop-noMdConv"><img loading="lazy" width="553" height="128" src="./media/files/wps16.jpg" data-is-external-image="true"></figure>上图是补丁TAG<p>选择完REPO方式和TAG后，执行以下命令进行代码同步</p><pre><code>repo init -u https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest -b android-14.0.0_r1
repo sync 
</code></pre><h3 id="构建系统soong编译系统"><strong>构建系统(Soong编译系统)</strong></h3><figure class="jop-noMdConv">参考：<a href="https://source.android.google.cn/docs/setup/build">https://source.android.google.cn/docs/setup/build</a><p>Make(.mk)和Soong(.bp)比较</p><p>以下是 Make 配置与 Soong 在 Soong 配置（Blueprint 或 .bp）文件中完成相同操作的比较。<br><img loading="lazy" width="553" height="254" src="./media/files/wps17.jpg" data-is-external-image="true"></p></figure><figure class="jop-noMdConv"><img loading="lazy" width="553" height="318" src="./media/files/wps18.jpg" data-is-external-image="true"> </figure><h3 id="构建android"><strong>构建Android</strong></h3><p>参考：<a href="https://source.android.google.cn/docs/setup/build/building">https://source.android.google.cn/docs/setup/build/building</a></p><p>设置环境(通过脚本导入命令)<br><code>. build/envsetup.sh</code><br>或<br><code>source build/envsetup.sh</code></p><p>通过hmm查看导入的命令</p><p>选择目标 <code>lunch aosp_arm-eng</code><br>或<br><code>lunch</code><br></p><figure class="jop-noMdConv"><img width="553" height="548" src="./media/files/wps19.jpg" data-is-external-image="true"> </figure><figure class="jop-noMdConv">通过菜单进行选择，菜单中的名称后缀解释如下：<br><img loading="lazy" width="553" height="151" src="./media/files/wps20.jpg" data-is-external-image="true"></figure><p>可以选择的硬件设备参考：<br><a href="https://source.android.google.cn/docs/setup/build/running?hl=zh-cn#selecting-device-build">https://source.android.google.cn/docs/setup/build/running?hl=zh-cn#selecting-device-build</a></p><h3 id="编译代码"><strong>编译代码</strong></h3><figure class="jop-noMdConv"><img loading="lazy" width="553" height="438" src="./media/files/wps21.jpg" data-is-external-image="true"> </figure><h3 id="模拟器启动"><strong>模拟器启动</strong></h3><p><code>emulator &amp;</code></p><h3 id="build指纹"><strong>build指纹</strong></h3><p>如需跟踪和报告与特定 Android build 相关的问题，请一定要了解 build 指纹。build 指纹是能让人看懂的唯一字符串，其中包含向每个 build 发出的制造商信息。有关详情，请参阅 Android 兼容性定义文档 (CDD) 中 Build 参数部分内的“FINGERPRINT”说明。<a href="https://source.android.google.cn/docs/compatibility/14/android-14-cdd#322_build_parameters">https://source.android.google.cn/docs/compatibility/14/android-14-cdd#322_build_parameters</a></p><p>build指纹表示特定的 Android 实现和修订版本。此唯一键可让应用开发者和其他人报告与特定固件版本相关的问题。如需了解 Android 问题报告流程，请参阅报告 bug。</p><p>build指纹封装了所有 Android 实现详情：</p><ul><li>PI：Android 和原生，以及软 API 行为</li><li>核心 API 和部分系统界面行为</li><li>CDD 中定义的兼容性和安全性要求</li><li>应用所采用的产品规范和 uses-feature 设置，用于定位符合预期要求的设备</li><li>硬件和软件组件的实现</li></ul><p>如需查看完整详情，请参阅 CDD。如需有关打造全新 Android 设备的说明，请参阅添加新设备。</p><h3 id="编译内核"><strong>编译内核</strong></h3><figure class="jop-noMdConv">设备内核+通用内核<br>参考：<a href="https://source.android.google.cn/docs/setup/build/building-kernels">https://source.android.google.cn/docs/setup/build/building-kernels</a><p><code>repo init -u https://android.googlesource.com/kernel/manifest -b BRANCH</code></p><p>以下是BRANCH可选的分支名称(最右边)<br><img width="553" height="47" src="./media/files/wps22.jpg" data-is-external-image="true"></p></figure><figure class="jop-noMdConv"><img loading="lazy" width="553" height="587" src="./media/files/wps23.jpg" data-is-external-image="true"> </figure><h6 id="以下是构建方法"><strong>以下是构建方法</strong></h6><p>Android 13之前<br><code>build/build.sh</code></p><p>Android 13及以后</p><pre><code>tools/bazel build //common:kernel_aarch64_dist
tools/bazel run //common:kernel_aarch64_dist -- --dist_dir=$DIST_DIR
</code></pre><h6 id="以下是一些tips："><strong>以下是一些Tips：</strong></h6><p>1. Android 11 引入了 GKI，用于将内核拆分为由 Google 维护的内核映像和由供应商维护的模块，二者分别单独构建;<br>2. 在 Android 12 中，Cuttlefish 和 Goldfish 融合，因此它们共享同一个内核：virtual_device;<br>3. Android 13 引入了使用 Bazel (Kleaf) 构建内核的功能，以取代 build.sh</p><p>如需详细了解如何使用 Bazel 构建 Android 内核，请参阅：Kleaf - 使用 Bazel 构建 Android 内核。<a href="https://android.googlesource.com/kernel/build/+/refs/heads/master/kleaf/README.md">https://android.googlesource.com/kernel/build/+/refs/heads/master/kleaf/README.md</a></p><h6 id="对设备和内核的-kleaf-支持"><strong>对设备和内核的 Kleaf 支持</strong></h6><figure class="jop-noMdConv">下表列出了对各个设备内核的 Kleaf 支持。对于未列出的设备，请与设备制造商联系。<br><img width="553" height="300" src="./media/files/wps24.jpg" data-is-external-image="true"></figure> <figure class="jop-noMdConv"><img loading="lazy" width="553" height="223" src="./media/files/wps25.jpg" data-is-external-image="true"> </figure><p>有关Android通用内核喝GKI解释，参考： <a href="https://source.android.google.cn/docs/core/architecture/kernel/android-common">https://source.android.google.cn/docs/core/architecture/kernel/android-common</a></p><h6 id="功能和启动内核"><strong>功能和启动内核</strong></h6><figure class="jop-noMdConv">每个 Android 平台版本都支持启动基于三个 Linux 内核版本中任意一个的新设备。如下表所示，Android 11 的启动内核为android-4.14-stable 、 android-4.19-stable和android11-5.4 。<p>由于更新平台版本时通常不需要升级内核，因此缺少平台版本最新功能的内核仍可用于启动设备。因此，即使将平台版本升级到 Android 11 后，专为 Android 10 设计的内核（例如android-4.19-q ）也可以在设备上使用。从 Android 12 开始，功能内核将少于启动内核，以限制功能内核的数量必须支持的稳定 KMI。<br><img loading="lazy" width="553" height="475" src="./media/files/wps26.jpg" data-is-external-image="true"> </p></figure><p>有关Android操作系统核心主题，包括架构、内核、HAL层等开发文档，可以参考：<br><a href="https://source.android.google.cn/docs/core">https://source.android.google.cn/docs/core</a></p><p>有关Android automotive的主题，可以参考：<br><a href="https://source.android.google.cn/docs/automotive">https://source.android.google.cn/docs/automotive</a></p><p>Android 14 Automotive 远程唤醒工作流示例<br><a href="https://source.android.google.cn/docs/automotive/remote_access">https://source.android.google.cn/docs/automotive/remote_access</a></p><h2 id="build-lineageos-for-xiaomi-mi-mix-2s"><strong>Build LineageOS for</strong> <strong>Xiaomi Mi MIX 2S</strong></h2><h3 id="lineageos介绍"><strong>LineageOS介绍</strong></h3><p>LineageOS（也称Lineage OS、Lineage OS Android Distribution）是一个面向智能手机和平板电脑的自由、免费、开放源代码的Android系统分支。它是深受欢迎的定制ROM CyanogenMod的继任者。它在2016年12月Cyanogen公司突然宣布停止开发并关闭项目基础设施后复刻而生。LineageOS于2016年12月24日正式启动，其源代码存放于GitHub。</p><p>由于Cyanogen公司保留了使用Cyanogen名称的权利，因此项目复刻后更名为LineageOS。</p><p>目前LineageOS最新版本是21，基于AOSP 14. 参考<a href="https://www.lineageos.org/Changelog-28/">https://www.lineageos.org/Changelog-28/</a></p><p>LineageOS的思路是，内核使用手机厂商或者SoC供应商提供的开源内核版本，或支持的二进制版本，系统源码使用AOSP，应用层自行开发的模式。所以源代码分为三个部分：</p><ul><li>1. AOSP源码，谷歌OpenSource托管</li><li>2. LineageOS APP 源码，Github托管</li><li>3. Kernel源码或二进制模组，Github托管，或使用脚本从手机端直接拉取</li></ul><p>基于这个模式，LineageOS支持的设备是有限的，谷歌手机因为内核开源，所以全系列支持，其它手机厂根据不同机型支持的情况也不同，参见：<a href="https://wiki.lineageos.org/devices/">https://wiki.lineageos.org/devices/</a></p><p>本文以小米 Mix 2s(代号Polaris)为例讲解<br>参考：<a href="https://wiki.lineageos.org/devices/polaris/build/">https://wiki.lineageos.org/devices/polaris/build/</a></p><h3 id="环境要求-1"><strong>环境要求</strong></h3><p>1. Mix 2s手机一台(可解锁)<br>2. 编译软硬件环境和AOSP要求差不多，按照之前AOSP的要求准备即可<br>3. 因为涉及到编译版本的刷机操作，所以需要准备platform-tools环境，可以安装Android Studio并配置SDK，也可以只下载platform-tools，地址: <a href="https://dl.google.com/android/repository/platform-tools-latest-linux.zip%EF%BC%8C">https://dl.google.com/android/repository/platform-tools-latest-linux.zip，</a><br>下载后配置环境变量：<br><code>unzip platform-tools-latest-linux.zip -d ~</code></p><p>在~/.profile文件中添加以下代码：</p><pre><code># add Android SDK platform tools to path
if [ -d &quot;$HOME/platform-tools&quot; ] ; then
    PATH=&quot;$HOME/platform-tools:$PATH&quot;
fi
</code></pre><p>运行 source ~/.profile 导入环境变量配置</p><p>4. 安装编译需要的库</p><pre><code>sudo apt install bc bison build-essential ccache curl flex g++-multilib gcc-multilib git git-lfs gnupg gperf imagemagick lib32readline-dev lib32z1-dev libelf-dev liblz4-tool libsdl1.2-dev libssl-dev libxml2 libxml2-utils lzop pngcrush rsync schedtool squashfs-tools xsltproc zip zlib1g-dev
</code></pre><p>如果是低于Ubuntu 23.10，还需要安装lib32ncurses5-dev libncurses5 libncurses5-dev</p><p>5. Java要求，如果是LineageOS 18.1+版本，源码自带JDK，无需自行安装</p><p>6. 如果是LineageOS 17.1+，还需要安装Python 3:<br><code>sudo apt install python-is-python3</code></p><h3 id="检出代码"><strong>检出代码</strong></h3><p>7. 创建安装目录</p><pre><code>mkdir -p ~/bin
mkdir -p ~/android/lineage
</code></pre><p>8. 下载repo</p><pre><code>curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo
chmod a+x ~/bin/repo
</code></pre><p>在~/.profile中添加以下代码</p><pre><code># set PATH so it includes user&#39;s private bin if it exists
if [ -d &quot;$HOME/bin&quot; ] ; then
    PATH=&quot;$HOME/bin:$PATH&quot;
fi
</code></pre><p>运行 source ~/.profile 导入环境变量配置</p><p>9. 配置git</p><pre><code>git config --global user.email &quot;you@example.com&quot;
git config --global user.name &quot;Your Name&quot;
git lfs install
</code></pre><p>10. 配置编译缓存(可选)</p><pre><code>export USE_CCACHE=1
export CCACHE_EXEC=/usr/bin/ccache
ccache -o compression=true
</code></pre><p>11. 初始化LineageOS 源代码仓库(以LineageOS 21为例)</p><pre><code>cd ~/android/lineage
repo init -u https://github.com/LineageOS/android.git -b lineage-21.0 --git-lfs
repo sync
</code></pre><p>注意：由于LineageOS的源代码包含AOSP，所以在repo init之后，sync之前做一点修改.</p><pre><code>进入到源码根目录/.repo/manifests，打开default.xml，找到remote name=&quot;aosp&quot;节点，修改fetch=&quot;https://mirrors.tuna.tsinghua.edu.cn/git/AOSP&quot;，保存退出后再运行repo sync.
</code></pre><p>经过漫长的等待，就会下载完源代码。一定要保证github访问稳定，否则会导致代码不完整甚至下载中断，可通过多次运行repo sync来保证代码完整性</p><p>12. 准备设备特殊代码<br>在源代码根目录运行以下命令</p><pre><code>source build/envsetup.sh
breakfast polaris
</code></pre><p>这会下载mix 2s的特殊设备配置文件和内核<br>如果你的设备已经刷过LineageOS，可以使用设备获取这些文件。<br>进入~/android/lineage/device/xiaomi/polaris 目录，接上手机并开启adb调试模式，运行<br><code>./extract-files.sh</code><br>脚本会从手机上直接获取所需的配置文件和内核。</p><h3 id="编译代码-1"><strong>编译代码</strong></h3><p>13. 编译<br>运行</p><pre><code>croot
brunch polaris
</code></pre><p>等待编译结束，时间与AOSP的编译时间相当</p><h3 id="刷机步骤"><strong>刷机步骤</strong></h3><p>14. 刷机<br>进入到out目录，找到两个文件<br>recovery.img // 这是LineageOS的recovery.<br>lineage-21.0-20240305-UNOFFICIAL-polaris.zip // 这是lineage的安装包<br>按照以下步骤开始刷机操作:<br>a) 解锁手机<br>b) 手机开启adb调试模式，adb -d reboot bootloader 进入到bootloader。也可以通过同时按住音量键下+电源键进入。进入到bootloader后使用fastboot devices查看设备是否识别<br>c) 刷入编译好的recovery：fastboot flash recovery recovery.img . 刷入后，不要直接重启进入到系统，而是按住音量上+电源键进入到recovery，如果不是LineageOS的图标，则需要重复b步骤后再次刷入recovery，这是因为Android目前使用A/B分区的方式保证升级的安全性，所以存在两个recovery分区，可能需要刷两次同时覆盖两个分区。<br>d) 进入到LineageOS后，三清，然后进入apply update from adb, 进入到sideload线刷模式<br>e) 在电脑端输入adb -d sideload lineage-21.0-20240305-UNOFFICIAL-polaris.zip ，等待100%后刷入成功，重启进入系统。系统刷完<br>f) 如果要刷入GMS，则在e步骤刷完zip后继续刷入其它GMS包，然后再重启即可。</p><hr><p>本文结束.</p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on 十月 29, 2024</p><div class="post__share"></div></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://blog.nasyes.cn/openharmonyzai-shu-mei-pai-4shang-de-chu-bu-yi-zhi-he-bian-yishua-jidiao-shi.html" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  OpenHarmony在树莓派4B上的初步移植和编译、刷机 "><span class="btn__text">OpenHarmony在树莓派4B上的初步移植和编译、刷机</span> <span class="btn__icon">→</span></a></div></nav></article></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p>© 2024 Powered by Publii CMS :: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank" rel="noopener">Theme</a> ported by the <a href="https://getpublii.com/customization-service/" target="_blank" rel="noopener">Publii Team</a></p></div></div></footer></div><script defer="defer" src="https://blog.nasyes.cn/assets/js/scripts.min.js?v=74fad06980c30243d91d72c7c57fcdb8"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>